<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate Normalization Parameters and Apply Global Normalization — normalize_global • pmartR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Normalization Parameters and Apply Global Normalization — normalize_global"><meta property="og:description" content="Calculates normalization parameters based on the data using the specified
subset and normalization functions with option to apply the normalization to
the data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Convenience_Functions.html">Convenience Functions</a>
    </li>
    <li>
      <a href="../articles/Data_Normalization.html">Data Normalization</a>
    </li>
    <li>
      <a href="../articles/Data_Object_Creation.html">Data Object Creation</a>
    </li>
    <li>
      <a href="../articles/Filter_Functionality.html">Filter Functions</a>
    </li>
    <li>
      <a href="../articles/Graphing_with_pmartR.html">Graphing with pmartR</a>
    </li>
    <li>
      <a href="../articles/RNAseq_Processing_Workflow.html">RNAseq Data Processing</a>
    </li>
    <li>
      <a href="../articles/Statistical_Analysis_with_pmartR.html">Statistical Analysis with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Trelliscope_Vignette.html">Using Trelliscope Functions with pmartR</a>
    </li>
    <li>
      <a href="../articles/Typical_Processing_Workflow.html">Typical Processing Workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pmartR/pmartR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Normalization Parameters and Apply Global Normalization</h1>
    <small class="dont-index">Source: <a href="https://github.com/pmartR/pmartR/blob/HEAD/R/normalize_global.R" class="external-link"><code>R/normalize_global.R</code></a></small>
    <div class="hidden name"><code>normalize_global.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates normalization parameters based on the data using the specified
subset and normalization functions with option to apply the normalization to
the data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">normalize_global</span><span class="op">(</span></span>
<span>  <span class="va">omicsData</span>,</span>
<span>  <span class="va">subset_fn</span>,</span>
<span>  <span class="va">norm_fn</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  apply_norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  backtransform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_prop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>omicsData</dt>
<dd><p>an object of the class 'pepData', 'proData', 'metabData',
'lipidData', 'nmrData', created by <code><a href="as.pepData.html">as.pepData</a></code>,
<code><a href="as.proData.html">as.proData</a></code>, <code><a href="as.metabData.html">as.metabData</a></code>,
<code><a href="as.lipidData.html">as.lipidData</a></code>, <code><a href="as.nmrData.html">as.nmrData</a></code>, respectively. The
function <code><a href="group_designation.html">group_designation</a></code> must have been run on omicsData to
use several of the subset functions (i.e. rip and ppp_rip).</p></dd>


<dt>subset_fn</dt>
<dd><p>character string indicating the subset function to use for
normalization. See details for the current offerings.</p></dd>


<dt>norm_fn</dt>
<dd><p>character string indicating the normalization function to use
for normalization. See details for the current offerings.</p></dd>


<dt>params</dt>
<dd><p>additional arguments passed to the specified subset function.
See details for parameter specification and default values.</p></dd>


<dt>apply_norm</dt>
<dd><p>logical argument indicating if the normalization should be
applied to the data. Defaults to FALSE. If TRUE, the normalization is
applied to the data and an S3 object of the same class as <code>omicsData</code>
(e.g. 'pepData') with normalized values in <code>e_data</code> is returned. If
FALSE, the normalization is not applied to the data and an S3 object of
class 'normRes' is returned.</p></dd>


<dt>backtransform</dt>
<dd><p>logical argument indicating if parameters for back
transforming the data, after normalization, should be calculated. Defaults
to FALSE. If TRUE, the parameters for back transforming the data after
normalization will be calculated, and subsequently included in the data
normalization if <code>apply_norm</code> is TRUE. See the details section for an 
explanation of how these factors are calculated.</p></dd>


<dt>min_prop</dt>
<dd><p>numeric threshold between 0 and 1 giving the minimum value
for the proportion of biomolecules subset (rows of <code>e_data</code>)</p></dd>


<dt>check.names</dt>
<dd><p>deprecated</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If apply_norm is FALSE, an S3 object of type 'normRes' is returned.
  This object contains a list with: subset method, normalization method,
  normalization parameters, number of biomolecules used in normalization, and
  proportion of biomolecules used in normalization. plot() and summary() methods
  are available for this object. If apply_norm is TRUE, then the normalized
  data is returned in an object of the appropriate S3 class (e.g. pepData).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Below are details for specifying function and parameter options.</p>
    </div>
    <div id="subset-functions">
    <h2>Subset Functions</h2>
    <p>Specifying a subset function indicates the subset
  of biomolecules (rows of <code>e_data</code>) that should be used for computing
  normalization factors. The following are valid options: "all", "los",
  "ppp", "complete", "rip", and "ppp_rip". The option "all" is the subset
  that includes all biomolecules (i.e. no subsetting is done). The option 
  "los" identifies the subset of the biomolecules associated with the top 
  <code>L</code> order statistics, where <code>L</code> is a proportion between 0 and 1.
  Specifically, the biomolecules falling within the top <code>L</code> proportion of highest
  absolute abundance are retained for each sample, and the union of these
  biomolecules is taken as the subset identified (Wang et al., 2006). The option
  "ppp" (originally stands for percentage of peptides present) identifies the
  subset of biomolecules that are present/non-missing for a minimum
  <code>proportion</code> of samples (Karpievitch et al., 2009; Kultima et al.,
  2009). The option "complete" retains molecules with no missing data across
  all samples, equivalent to "ppp" with proportion = 1. The option "rip"
  identifies biomolecules with complete data that have a p-value greater than a
  defined threshold <code>alpha</code> (common values include 0.1 or 0.25) when
  subjected to a Kruskal-Wallis test based (non-parametric one-way ANOVA) on
  group membership (Webb-Robertson et al., 2011). The option "ppp_rip" is
  equivalent to "rip" however rather than requiring biomolecules with complete
  data, biomolecules with at least a <code>proportion</code> of non-missing values are
  subject to the Kruskal-Wallis test.</p>
    </div>
    <div id="normalization-functions">
    <h2>Normalization Functions</h2>
    <p>Specifying a normalization function
  indicates how normalization scale and location parameters should be
  calculated. The following are valid options: "median", "mean", "zscore",
  and "mad". For median centering, the location estimates are the sample-wise
  medians of the subset data and there are no scale estimates. For mean
  centering, the location estimates are the sample-wise means of the subset
  data and there are no scale estimates. For z-score transformation, the
  location estimates are the subset means for each sample and the scale
  estimates are the subset standard deviations for each sample. For median
  absolute deviation (MAD) transformation, the location estimates are the
  subset medians for each sample and the scale estimates are the subset MADs
  for each sample.</p>
    </div>
    <div id="specifying-subset-parameters-using-the-params-argument">
    <h2>Specifying Subset Parameters Using the <code>params</code> Argument</h2>
    

<p>Parameters for the chosen subset function should be specified in a list
  with the function specification followed by an equal sign and the desired
  parameter value. For example, if LOS with 0.1 is desired, one should use
  <code>params = list(los = 0.1)</code>. ppp_rip can be specified in one of two
  ways: specify the parameters with each separate function or combine using a
  nested list (e.g. <code>params = list(ppp_rip = list(ppp = 0.5, rip =
  0.2))</code>).</p>
<p>The following functions have parameters that can be specified:</p><table class="table table"><tr><td>los</td><td>a value between 0 and 1 indicating the top
  proportion of order statistics. Defaults to 0.05 if unspecified.</td></tr><tr><td></td><td></td></tr><tr><td>ppp</td><td>a value between 0 and 1 specifying the proportion of samples
  that must have non-missing values for a biomolecule to be retained. Defaults to
  0.5 if unspecified.</td></tr><tr><td></td><td></td></tr><tr><td>rip</td><td>a value between 0 and 1
  specifying the p-value threshold for determining rank invariance. Defaults
  to 0.2 if unspecified.</td></tr><tr><td></td><td></td></tr><tr><td>ppp_rip</td><td>two values corresponding
  to the RIP and PPP parameters above. Defaults to 0.5 and 0.2, respectively.</td></tr></table></div>
    <div id="backtransform">
    <h2>Backtransform</h2>
    <p>The purpose of back transforming data is to ensure
  values are on a scale similar to their raw values before normaliztion. The
  following values are calculated and/or applied for backtransformation
  purposes:</p><table class="table table"><tr><td><code>median</code></td><td>scale is NULL and location
  parameter is a global median across all samples</td></tr><tr><td></td><td></td></tr><tr><td><code>mean</code></td><td>scale is NULL and location parameter is a global median across all
  samples</td></tr><tr><td></td><td></td></tr><tr><td><code>zscore</code></td><td>scale is pooled standard deviation
  and location is global mean across all samples</td></tr><tr><td></td><td></td></tr><tr><td><code>mad</code></td><td>scale is pooled median absolute deviation and location is global median
  across all samples</td></tr></table></div>
    <div id="references">
    <h2>References</h2>
    <p>Webb-Robertson BJ, Matzke MM, Jacobs JM, Pounds JG, Waters KM. A
  statistical selection strategy for normalization procedures in LC-MS
  proteomics experiments through dataset-dependent ranking of normalization
  scaling factors. Proteomics. 2011;11(24):4736-41.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lisa Bramer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pmartR/pmartRdata" class="external-link">pmartRdata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mymetab</span> <span class="op">&lt;-</span> <span class="fu"><a href="edata_transform.html">edata_transform</a></span><span class="op">(</span></span>
<span>  omicsData <span class="op">=</span> <span class="va">metab_object</span>,</span>
<span>  data_scale <span class="op">=</span> <span class="st">"log2"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mymetab</span> <span class="op">&lt;-</span> <span class="fu"><a href="group_designation.html">group_designation</a></span><span class="op">(</span></span>
<span>  omicsData <span class="op">=</span> <span class="va">mymetab</span>,</span>
<span>  main_effects <span class="op">=</span> <span class="st">"Phenotype"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">norm_object</span> <span class="op">&lt;-</span> <span class="fu">normalize_global</span><span class="op">(</span></span>
<span>  omicsData <span class="op">=</span> <span class="va">mymetab</span>,</span>
<span>  subset_fn <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  norm_fn <span class="op">=</span> <span class="st">"median"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">norm_data</span> <span class="op">&lt;-</span> <span class="fu">normalize_global</span><span class="op">(</span></span>
<span>  omicsData <span class="op">=</span> <span class="va">mymetab</span>,</span>
<span>  subset_fn <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  norm_fn <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  apply_norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  backtransform <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lisa Bramer, Kelly Stratton, Daniel Claborne.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

